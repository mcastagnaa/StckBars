scale_fill_manual(values = c("blue","green", "yellow", "red")) +
scale_fill_hue(l=40)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
scale_fill_manual(values = c("blue","green", "yellow", "red")) +
scale_fill_hue(l=50)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
scale_fill_manual(values = c("blue","green", "yellow", "red")) +
scale_fill_hue(l=60)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
scale_y_continuous(formatter = 'percent')
library(scales)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
scale_y_continuous(formatter = 'percent')
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
labels = percent_format()
ggplot()+
geom_bar(data=RawData,
aes(y=percent_format(Percentage), x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
ggplot()+
geom_bar(data=RawData,
aes(y=percen(Percentage), x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
ggplot()+
geom_bar(data=RawData,
aes(y=percent(Percentage), x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
percent_format()
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
percent_format()(RawData$Percentage)
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
scale_y_coutinous(formatter="percentage")
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens")
scale_y_coutinous(label =percent)
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens") +
scale_y_coutinous(labels =percent)
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens") +
scale_y_continous(labels =percent)
percent_format()(RawData$Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') + facet_grid(~ Period) +
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#            facet_grid(~ Period) +
facet_grid(c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#            facet_grid(~ Period) +
facet_grid(c("1m", "3m", "YtD", "1y", "2y", "3y", "5y")) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#            facet_grid(~ Period) +
facet_grid("1m", "3m", "YtD", "1y", "2y", "3y", "5y") +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
facets_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#            facet_grid(~ Period) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Frequency, y = pos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = pos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#            geom_text(aes(label = Percentage, y = pos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = cumsum(Percentage)), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = Percentage), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = cumsum(Percentage) - (0.5 * Percentage)), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
library(ggplot2)
library(scales)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = cumsum(Percentage) - (0.5 * Percentage)), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
RawData$YPos <- cumsum(Percentage) - (0.5 * Percentage)
library(ggplot2)
library(scales)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData$YPos <- cumsum(Percentage) - (0.5 * Percentage)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = YPos, size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
1
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = YPos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
head(RawData)
RawData$YPos <- cumsum(Percentage) - (0.5 * Percentage)
RawData$YPos <- cumsum(RawData$Percentage) - (0.5 * RawData$Percentage)
head(RawData)
RawData <- ddply(RawData, Period, transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
library(plyr)
RawData <- ddply(RawData, Period, transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
RawData <- ddply(RawData, .(Period), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
RawData <- ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
RawData <- ddply(RawData, .c(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
RawData <- ddply(RawData, . c(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
RawData <- ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
View(RawData)
View(RawData)
library(ggplot2)
library(scales)
library(plyr)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData <- ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData <- ddply(RawData, .(Period+Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
RawData$RollLabel <- Period + Quarter
RawData$RollLabel <- RawData$Period + RawData$Quarter
RawData$RollLabel <- as.character(RawData$Period) + as.character(RawData$Quarter)
RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
head(RawData)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData <- ddply(RawData, .(RollLabel), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
head(RawData)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData$test <- ddply(RawData, .(RollLabel), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
RawData$test <- ddply(RawData, .(RollLabel), mutate, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
ddply(RawData, .(RollLabel), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
library(ggplot2)
library(scales)
library(plyr)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(RawData$Percentage) - (0.5 * RawData$Percentage))
head(RawData)
ddply(RawData, .(RollLabel), transform, Ypos = cumsum(RawData$Percentage))
ddply(RawData, .(RollLabel), transform, Ypos = cumsum(Percentage))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage) - (0.5 * Percentage))
library(ggplot2)
library(scales)
library(plyr)
RawData <- read.csv("RawData.csv", header = TRUE)
#RawData$RollLabel <- paste0(as.character(RawData$Period),as.character(RawData$Quarter), collapse=NULL)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage) - (0.5 * Percentage))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage - 0.5(Percentage)))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage - 0.5*(Percentage)))
ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage) - 0.5*(Percentage))
RawData <- ddply(RawData, .(Period, Quarter), transform, Ypos = cumsum(Percentage) - 0.5*(Percentage))
#ddply(RawData, .(RollLabel), transform, Ypos = cumsum(Percentage))
head(RawData)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, y = YPos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(label = Percentage, x= Quarter, y = YPos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
#  geom_text(aes(label = Percentage, x= Quarter, y = YPos), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(aes(x= Quarter, y = YPos, ymax = Percentage, label = Percentage), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
geom_text(position= "stack", aes(x= Quarter, y = YPos, ymax = Percentage, label = Percentage), size = 3) +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent)+
geom_text(aes(y = YPos, label = Percentage), size = 3)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(y = YPos, label = Percentage, size = 3))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(y = Ypos, label = Percentage, size = 3))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(x = Quarter, y = Ypos, label = Percentage, size = 3))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(x = Quarter, y = Ypos, label = percent(Percentage), size = 3))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(x = Quarter, y = Ypos, label = percent(round(Percentage, digits=2), size = 2))
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
geom_text(data=RawData, aes(x = Quarter, y = Ypos, label = percent(round(Percentage, digits=2)), size = 2))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData, aes(x = Quarter, y = Ypos, label = percent(round(Percentage, digits=2)), size = 2))
head(RawData)
RawData$BarWidth <- with(RawData, ifelse(Quarter="Last", 1, 0.75))
RawData$BarWidth <- with(RawData, ifelse(Quarter == "Last", 1, 0.75))
head(RawData)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile, width = BarWidth),
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
library(ggplot2)
library(scales)
library(plyr)
RawData <- read.csv("RawData.csv", header = TRUE)
RawData$Period_order <- factor(RawData$Period, levels= c("1m", "3m", "YtD", "1y", "2y", "3y", "5y"))
RawData <- ddply(RawData, .(Period, Quarter),
transform, Ypos = cumsum(Percentage) - 0.5*(Percentage))
RawData$BarWidth <- with(RawData, ifelse(Quarter == "Last", 1, 0.75))
head(RawData)
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile, width = BarWidth),
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), #, width = BarWidth
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
RawData$BarWidth <- with(RawData, ifelse(Quarter == "Last", 1.5, 1))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile, width = BarWidth), #
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
RawData$BarWidth <- with(RawData, ifelse(Quarter == "Last", 1, 0.85))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile, width = BarWidth), #
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), #, width = BarWidth
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) +
geom_text(data=RawData,
aes(x = Quarter, y = Ypos,
label = percent(round(Percentage, digits=2)),
size = 2))
#            scale_fill_manual(values = c("blue","green", "yellow", "red"))
ggplot()+
geom_bar(data=RawData,
aes(y=Percentage, x = Quarter, fill = Quartile), #, width = BarWidth
stat= "identity",
position = 'stack') +
facet_grid(. ~ Period_order) +
scale_fill_brewer(palette="Greens") +
scale_y_continuous(labels =percent) #+
head(RawData)
